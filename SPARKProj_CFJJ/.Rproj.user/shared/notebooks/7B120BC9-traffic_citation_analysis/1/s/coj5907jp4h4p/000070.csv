"0","home <- ""~/johnsonlab/aodom/cs506/SPARKProj_CFJJ/ds-cfjj-police-accountability/Team1/Data/DOT_Citations_data/"""
"0","read_law <- paste(home,"
"0","                  ""Law Enforcement Misconduct Database (9.28.21) cpcs.xlsx"","
"0","                   sep = """")"
"0","lawenf <- readxl::read_xlsx(read_law)"
"2","Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i = sheet,  :"
"2","
 "
"2"," Expecting logical in L1487 / R1487C12: got 'flagged for prior roster years issue and criminal conviction; appears last 2018; wife still works for them?'
"
"0","# Subset of roster to merge on"
"0","lowell_lawenf <- lawenf %>% filter(`Agency` == ""Lowell Police Department"") %>%"
"0","  select(`Full Name`, `Internal Unique ID`) %>% "
"0","  tidyr::separate(`Full Name`, c(""LAST NAME"", ""FIRST NAME"")) %>%"
"0","  mutate(`Full Name` = paste(`LAST NAME`, `FIRST NAME`, sep = "", "")) %>%"
"0","  select(`Full Name`, `Internal Unique ID`)"
"2","Warning:"
"2"," Expected 2 pieces. Additional pieces discarded in 15 rows [2, 89, 119, 133, 190, 261, 274, 301, 322, 323, 375, 390, 428, 442, 459].
"
"0","# Obtained Lowell badge numbers"
"0","lowell_badges <- readxl::read_xls(""~/johnsonlab/aodom/cs506/SPARKProj_CFJJ/ds-cfjj-police-accountability/Team1/Data/DOT_Citations_data/LowellBadgeNumbers.xls"", skip = 1)[, c(1, 3:4)] %>% "
"0","  filter(!is.na(BADGE)) %>%"
"0","  tidyr::separate(`FIRST NAME`, c(""FIRST NAME"")) %>%"
"0","  tidyr::separate(`LAST NAME`, c(""LAST NAME"")) %>%"
"0","  mutate(`Full Name` = paste(`LAST NAME`, `FIRST NAME`, sep = "", ""),"
"0","         BADGE = str_remove(BADGE, ""[^[:alnum:]]""),"
"0","         BADGE = str_remove_all(BADGE, ""\\*"")) %>%"
"0","  select(`Badge Num` = BADGE, `Full Name`) %>%"
"0","  arrange(`Full Name`)"
"2","New names:
* `` -> ...5
* `` -> ...6
* `` -> ...7
* `` -> ...8
"
"2","Warning:"
"2"," Expected 1 pieces. Additional pieces discarded in 41 rows [7, 14, 17, 19, 23, 24, 29, 30, 38, 40, 42, 44, 45, 46, 47, 48, 53, 54, 55, 56, ...].
"
"2","Warning:"
"2"," Expected 1 pieces. Additional pieces discarded in 36 rows [34, 39, 44, 47, 49, 64, 65, 69, 71, 73, 76, 79, 105, 116, 120, 127, 151, 153, 161, 187, ...].
"
"0","merged <- lowell_badges %>%"
"0","  left_join(lowell_lawenf, ., by = ""Full Name"") %>%"
"0","  filter(!is.na(`Badge Num`)) %>%"
"0","  distinct(`Internal Unique ID`, .keep_all = TRUE) %>%"
"0","  select(-`Full Name`)"
"0",""
"0","ind <- which(lawenf$`Internal Unique ID` %in% merged$`Internal Unique ID`)"
"0","lawenf[ind, ""Badge Num""] <- merged$`Badge Num`"
"0","write.csv(lawenf, paste(home, ""LawEnforcementMisconductDatabase_11_17_21_cpcs.csv"","
"0","                        sep = """"), row.names = FALSE)"
